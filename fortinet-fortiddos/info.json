{
  "name": "fortinet-fortiddos",
  "version": "1.0.0",
  "label": "Fortinet FortiDDoS",
  "description": "FortiDDoS Protection Solution defends enterprise data centers against DDoS attacks by leveraging an extensive collection of known DDoS methodologies, creating a multi-layered approach to mitigate attacks.  It also analyzes the behavior of data to detect new attacks, allowing it to stop zero-day threats.",
  "publisher": "Fortinet",
  "cs_approved": true,
  "cs_compatible": true,
  "icon_small_name": "fortiddos_32x32.png",
  "icon_large_name": "fortiddos_80x80.png",
  "category": "Network Security",
  "help_online": "",
  "configuration": {
    "fields": [
      {
        "title": "Server Address",
        "type": "text",
        "name": "server_address",
        "required": true,
        "visible": true,
        "editable": true,
        "description": "URL of the FortiDDoS appliance to which you will connect and perform automated operations."
      },
      {
        "title": "Username",
        "type": "text",
        "name": "username",
        "required": true,
        "visible": true,
        "editable": true,
        "description": "Username to access your FortiDDoS appliance to which you will connect and perform automated operations."
      },
      {
        "title": "Password",
        "type": "password",
        "name": "password",
        "required": true,
        "visible": true,
        "editable": true,
        "description": "Password to access your FortiDDoS appliance to which you will connect and perform automated operations."
      },
      {
        "title": "Verify SSL",
        "type": "checkbox",
        "name": "verify_ssl",
        "required": false,
        "visible": true,
        "editable": true,
        "value": true,
        "description": "Specifies whether the SSL certificate for the server is to be verified or not."
      }
    ]
  },
  "operations": [
    {
      "title": "Get SPP Settings",
      "operation": "get_spp_settings",
      "description": "Retrieves the service protection profile settings of the FortiDDoS appliance of the given SPP name.",
      "category": "investigation",
      "annotation": "get_spp_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "SPP Name",
          "type": "text",
          "name": "spp",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "SPP-0",
          "tooltip": "Name of the service protection profile",
          "description": "Name of the Service protection profile to get setting details."
        },
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "ddos_spp_setting",
          "options": [
            "ddos_spp_setting",
            "ddos_spp_firewall_service",
            "ddos_spp_firewall_policy",
            "ddos_spp_firewall_address",
            "ddos_spp_firewall_address6",
            "ddos_spp_tcp_session_extended_timeout_policy",
            "ddos_spp_threshold_scalar",
            "ddos_spp_threshold_http_methods",
            "ddos_spp_threshold_protocol",
            "ddos_spp_threshold_tcp_ports",
            "ddos_spp_threshold_udp_ports",
            "ddos_spp_threshold_icmp_type_codes",
            "ddos_spp_threshold_http_urls",
            "ddos_spp_threshold_http_hosts",
            "ddos_spp_threshold_http_referers",
            "ddos_spp_threshold_http_cookies",
            "ddos_spp_threshold_http_user_agents"
          ],
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS.\nFollowing are possible resource names: ddos_spp_setting, ddos_spp_firewall_service, ddos_spp_firewall_policy, ddos_spp_firewall_address, ddos_spp_firewall_address6, ddos_spp_tcp_session_extended_timeout_policy, ddos_spp_threshold_scalar, ddos_spp_threshold_http_methods, ddos_spp_threshold_protocol, ddos_spp_threshold_tcp_ports, ddos_spp_threshold_udp_ports, ddos_spp_threshold_icmp_type_codes, ddos_spp_threshold_http_urls, ddos_spp_threshold_http_hosts, ddos_spp_threshold_http_referers, ddos_spp_threshold_http_cookies, ddos_spp_threshold_http_user_agents."
        }
      ],
      "output_schema": {}
    },
    {
      "title": "Get Global Settings",
      "operation": "get_global_settings",
      "description": "Retrieves settings from the global settings of the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "text",
          "name": "resource_name",
          "required": true,
          "visible": false,
          "editable": true,
          "tooltip": "Global Settings > Settings > Settings",
          "value": "ddos_global_setting",
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS."
        }
      ],
      "output_schema": {
        "query": "",
        "success": "",
        "message": "",
        "data": [
          {
            "link-down-synchronization": "",
            "blocking-period": "",
            "source-blocking-period": "",
            "extended-blocking-period": "",
            "drop-threshold-within-blocking-period": "",
            "url-per-source-observation-period": "",
            "http-source-observation-period": "",
            "ip-v6-prefix-length": "",
            "source-mac-address-aggressive-aging": "",
            "http-anomaly": "",
            "geo-location": "",
            "ipv6-prefix": "",
            "http-partial-request-per-source-per-second-threshold": "",
            "http-partial-request-to-response-observation-period": "",
            "local-address-anti-spoofing": "",
            "asymmetric-mode": "",
            "asymmetric-mode-allow-inbound-synack": "",
            "tap-mode": "",
            "drop-http-range-header": "",
            "dns-response-size": "",
            "power-fail-bypass-mode": "",
            "signaling-mode": "",
            "invalid-icmp-anomaly": "",
            "spp-switching-threshold-measurement-unit": "",
            "persistent-http-transactions": "",
            "reboot-on-graceful-recovery": "",
            "drop-threshold-for-foreign-packets": "",
            "dpc-timeout": "",
            "gtp-protocol-inspection": "",
            "lq-apply-schedule": "",
            "lq-drop-threshold": ""
          }
        ]
      }
    },
    {
      "title": "Get Global Service Protection Profiles",
      "operation": "get_global_settings",
      "description": "Retrieves the global service protection profile details from the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "Switching Policy",
          "tooltip": "Global Settings > Service Protection Profiles",
          "options": [
            "Switching Policy",
            "SPP Policy",
            "SPP Policy Group"
          ],
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS.\nFollowing are possible resource names: \"Switching Policy\", \"SPP Policy\", \"SPP Policy Group\"."
        }
      ],
      "conditional_output_schema": [
        {
          "condition": "{{true}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [],
            "message": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Switching Policy'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "enable-switching": "",
                "timeout": "",
                "start-timeout": "",
                "switching-type": ""
              }
            ]
          }
        }
      ]
    },
    {
      "title": "Get Settings",
      "operation": "get_global_settings",
      "description": "Retrieves the internal sub resources from settings of the FortiDDoS global settings.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "tooltip": "Global Settings > Settings",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "HTTP Service Ports",
          "options": [
            "HTTP Service Ports",
            "UDP Service Ports",
            "Signaling",
            "Service Provider Address"
          ],
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS.\nFollowing are possible resource names: HTTP Service Ports, UDP Service Ports, Signaling, Service Provider Address."
        }
      ],
      "output_schema": {
        "success": "",
        "query": "",
        "data": [],
        "message": ""
      }
    },
    {
      "title": "Get Global Settings Address",
      "operation": "get_global_settings",
      "description": "Retrieves the global setting address of the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "Address Config",
          "tooltip": "Global Settings > Address",
          "options": [
            "Local Address Config",
            "Local Address Config IPv6",
            "Address Config",
            "Address Config IPv6"
          ],
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS.\nFollowing are possible resource names: Local Address Config, Local Address Config IPv6, Address Config, Address Config IPv6."
        }
      ],
      "conditional_output_schema": [
        {
          "condition": "{{this['resource_name'] === 'Local Address Config'}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [
              {
                "mkey": "",
                "ip-netmask": ""
              }
            ],
            "message": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Local Address Config IPv6'}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [
              {
                "mkey": "",
                "ip-prefix": ""
              }
            ],
            "message": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Address Config'}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [
              {
                "mkey": "",
                "type": "",
                "ip-netmask": "",
                "ip-address": "",
                "geo-location": ""
              }
            ],
            "message": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Address Config IPv6'}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [
              {
                "mkey": "",
                "type": "",
                "ipv6-addr-prefix": "",
                "ipv6-address": ""
              }
            ],
            "message": ""
          }
        }
      ]
    },
    {
      "title": "Get IP Reputation",
      "operation": "get_global_settings",
      "description": "Retrieves the IP reputation details of the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": false,
          "editable": true,
          "tooltip": "Global Settings > IP Reputation",
          "value": "ddos_global_ip_reputation",
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS. Eg: ddos_global_ip_reputation"
        }
      ],
      "output_schema": {
        "success": "",
        "query": "",
        "data": [
          {
            "ip-reputation-status": "",
            "override-server-ip": "",
            "ip-reputation-ip-address": "",
            "ip-reputation-schedule-type": "",
            "ip-reputation-schedule-hour": "",
            "ip-reputation-schedule-weekday": "",
            "ip-reputation-category": "",
            "ip-reputation-tunnel": "",
            "ip-reputation-tunnel-address": "",
            "ip-reputation-tunnel-port": "",
            "ip-reputation-tunnel-user": "",
            "ip-reputation-tunnel-password": ""
          }
        ],
        "message": ""
      }
    },
    {
      "title": "Get Domain Reputation",
      "operation": "get_global_settings",
      "description": "Retrieves the IP reputation details of the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": false,
          "editable": true,
          "tooltip": "Global Settings > Domain Reputation",
          "value": "ddos_global_domain_reputation",
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS. Eg: ddos_global_domain_reputation"
        }
      ],
      "output_schema": {
        "query": "",
        "success": "",
        "message": "",
        "data": [
          {
            "domain-reputation-status": "",
            "override-server-ip": "",
            "domain-reputation-ip-address": "",
            "domain-reputation-schedule-type": ""
          }
        ]
      }
    },
    {
      "title": "Get Proxy IP",
      "operation": "get_global_settings",
      "description": "Retrieves the proxy IP details of the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": false,
          "editable": true,
          "value": "ddos_global_proxy_ip",
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS. Eg: ddos_global_proxy_ip"
        }
      ],
      "output_schema": {
        "query": "",
        "success": "",
        "message": "",
        "data": [
          {
            "auto-proxy-ip-status": "",
            "header-proxy-ip-status": "",
            "header-proxy-type": "",
            "concurrent-connections-per-source": "",
            "proxy-ip-threshold-factor": "",
            "proxy-ip-percent-present": "",
            "observation-period": "",
            "download-list": "",
            "backup-status": ""
          }
        ]
      }
    },
    {
      "title": "Get Proxy IP Policy",
      "operation": "get_global_settings",
      "description": "Retrieves the proxy IP policy details of the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": false,
          "editable": true,
          "value": "ddos_global_proxyip_policy",
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS. Eg: ddos_global_proxyip_policy"
        }
      ],
      "output_schema": {
        "query": "",
        "success": "",
        "message": "",
        "data": []
      }
    },
    {
      "title": "Get Do Not Track Policy",
      "operation": "get_global_settings",
      "description": "Retrieves the global settings of the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "Do Not Track Policy",
          "options": [
            "Do Not Track Policy",
            "Do Not Track Policy IPv6"
          ],
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS.\nFollowing are possible resource names: Do Not Track Policy, Do Not Track Policy IPv6"
        }
      ],
      "output_schema": {
        "success": "",
        "query": "",
        "data": [
          {
            "mkey": "",
            "source-address": "",
            "do-not-track-action": ""
          }
        ],
        "message": ""
      }
    },
    {
      "title": "Get Access Control List",
      "operation": "get_global_settings",
      "description": "Retrieves the access control list of global settings from the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "Global Settings > Access Control List",
          "value": "Access Control List",
          "options": [
            "Access Control List",
            "Access Control List IPv6",
            "Advanced Settings: Distress ACL"
          ],
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS.\nFollowing are possible resource names: Access Control List, Access Control List IPv6, Advanced Settings: Distress ACL."
        }
      ],
      "conditional_output_schema": [
        {
          "condition": "{{this['resource_name'] === 'Access Control List' || this['resource_name'] === 'Access Control List IPv6'}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [
              {
                "mkey": "",
                "action": "",
                "source-address": ""
              }
            ],
            "message": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Advanced Settings: Distress ACL'}}",
          "output_schema": [
            {
              "mkey": "",
              "acl-enable": "",
              "rrd-entry": "",
              "fragment": "",
              "fragment-type": "",
              "tcp-control-flag": "",
              "tcp-control-flag-options": "",
              "ttl": "",
              "ttl-value": "",
              "dscp": "",
              "dscp-value": "",
              "protocol": "",
              "protocol-number": "",
              "icmp": "",
              "icmp-type": "",
              "icmp-code": "",
              "source-ip": "",
              "source-ipv4-netmask": "",
              "destination": "",
              "destination-ipv4-netmask": "",
              "destination-subnet": "",
              "destination-spp": "",
              "source-port": "",
              "source-port-start": "",
              "source-port-end": "",
              "destination-port": "",
              "destination-port-start": "",
              "destination-port-end": "",
              "system-generated": ""
            }
          ]
        }
      ]
    },
    {
      "title": "Get Bypass MAC",
      "operation": "get_global_settings",
      "description": "Retrieves the bypass MAC details of the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": false,
          "editable": true,
          "value": "ddos_global_bypass_macs",
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS. Eg: ddos_global_bypass_macs"
        }
      ],
      "output_schema": {
        "query": "",
        "success": "",
        "message": "",
        "data": [
          {
            "mkey": "",
            "mac-address": ""
          }
        ]
      }
    },
    {
      "title": "Get System Settings",
      "operation": "get_system_settings",
      "description": "Retrieves the system settings information from FortiDDoS.",
      "category": "investigation",
      "annotation": "get_system_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Primary Resource Name",
          "type": "select",
          "name": "primary_resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "Interface",
          "options": [
            "Network",
            "High Availability",
            "Admin",
            "Authentication",
            "SNMP",
            "Certificate"
          ],
          "onchange": {
            "Network": [
              {
                "title": "Resource Name",
                "type": "select",
                "name": "resource_name",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "Interface",
                "options": [
                  "Interface",
                  "DNS",
                  "Static Route"
                ],
                "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS.\nFollowing are possible resource names: Interface, DNS, Static Route."
              }
            ],
            "High Availability": [
              {
                "title": "Resource Name",
                "type": "text",
                "name": "resource_name",
                "required": true,
                "visible": false,
                "editable": true,
                "value": "High Availability",
                "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS."
              }
            ],
            "Admin": [
              {
                "title": "Resource Name",
                "type": "select",
                "name": "resource_name",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "Settings",
                "options": [
                  "Admin User",
                  "Access Profile",
                  "Settings"
                ],
                "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS.\nFollowing are possible resource names: Admin User, Access Profile, Settings."
              }
            ],
            "Authentication": [
              {
                "title": "Resource Name",
                "type": "select",
                "name": "resource_name",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "Settings",
                "options": [
                  "Auth Radius",
                  "Auth LDAP",
                  "Auth TACACS+"
                ],
                "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS.\nFollowing are possible resource names: Auth Radius, Auth LDAP, Auth TACACS+"
              }
            ],
            "SNMP": [
              {
                "title": "Resource Name",
                "type": "select",
                "name": "resource_name",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "System Information",
                "options": [
                  "System Information",
                  "SNMP Threshold",
                  "SNMP Community"
                ],
                "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS.\nFollowing are possible resource names: System Information, SNMP Threshold, SNMP Community."
              }
            ],
            "Certificate": [
              {
                "title": "Resource Name",
                "type": "text",
                "name": "resource_name",
                "required": true,
                "visible": false,
                "editable": true,
                "value": "Certificate",
                "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS."
              }
            ]
          },
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS.\nFollowing are possible resource names: Network, High Availability, Admin, Authentication, SNMP, Certificate."
        }
      ],
      "conditional_output_schema": [
        {
          "condition": "{{true}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [],
            "message": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Auth LDAP'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "dn": "",
                "cnid": "",
                "port": "",
                "state": "",
                "domain": "",
                "secure": "",
                "server": "",
                "profile": "",
                "password": "",
                "username": "",
                "bind-type": "",
                "is-spp-admin": "",
                "trusted-host": "",
                "is-system-admin": "",
                "default-spp-policy-group": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Auth Radius'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "port": "",
                "state": "",
                "domain": "",
                "nas_ip": "",
                "secret": "",
                "server": "",
                "profile": "",
                "auth_prot": "",
                "is-spp-admin": "",
                "trusted-host": "",
                "backup-secret": "",
                "backup-server": "",
                "is-system-admin": "",
                "default-spp_policy-group": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'SNMP Threshold'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "cpu": "",
                "mem": "",
                "logdisk": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'System Information'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "status": "",
                "contact": "",
                "location": "",
                "engine-id": "",
                "description": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Interface'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "ip": "",
                "ip6": "",
                "mkey": "",
                "type": "",
                "speed": "",
                "expand": "",
                "status": "",
                "allowaccess": "",
                "logical-name": "",
                "asymmetric-mirror": "",
                "dropped-packet-capture": "",
                "forward-error-correction": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'DNS'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "ip_second": "",
                "ip_primary": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Static Route'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "gw": "",
                "dest": "",
                "mkey": "",
                "status": "",
                "interface": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'High Availability'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "ip": "",
                "ip6": "",
                "mkey": "",
                "type": "",
                "speed": "",
                "expand": "",
                "status": "",
                "allowaccess": "",
                "logical-name": "",
                "asymmetric-mirror": "",
                "dropped-packet-capture": "",
                "forward-error-correction": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Settings'}}",
          "output_schema": {
            "data": [
              {
                "hostname": "",
                "ssh-port": "",
                "http-port": "",
                "https-port": "",
                "telnet-port": "",
                "tls-version-1.1": "",
                "tls-version-1.2": "",
                "tls-version-1.3": "",
                "remoteauthtimeout": "",
                "admin-idle-timeout": "",
                "sys-global-language": "",
                "private-data-encryption": "",
                "https-server-certificate": "",
                "private-data-encryption-key": ""
              }
            ],
            "query": "",
            "message": "",
            "success": ""
          }
        }
      ]
    },
    {
      "title": "Get Log Settings",
      "operation": "get_log_settings",
      "description": "Retrieves log information from the FortiDDoS.",
      "category": "investigation",
      "annotation": "get_log_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "log_local",
          "options": [
            "log_local",
            "log_remote",
            "log_setting_ddos_attack_remote",
            "ddos_global_attack_event_purge",
            "log_setting_snmp_trap_receivers",
            "log_report",
            "ddos_global_attack_report_purge",
            "log_setting_remote_log_settings",
            "alertemail_recipient",
            "alertemail_server",
            "alertemail_setting"
          ],
          "description": "Specify the name of the resource whose information you want to retrieve from FortiDDoS.\nFollowing are possible resource names: log_local, log_remote, log_setting_ddos_attack_remote, ddos_global_attack_event_purge, log_setting_snmp_trap_receivers, log_report, ddos_global_attack_report_purge, log_setting_remote_log_settings, alertemail_recipient, alertemail_server, alertemail_setting"
        }
      ]
    },
    {
      "title": "Get Attack Information",
      "operation": "get_attack_information",
      "description": "Retrieves attack information from FortiDDoS based on the SPP, Direction and Period you have specified.",
      "category": "investigation",
      "annotation": "get_attack_information",
      "enabled": true,
      "parameters": [
        {
          "title": "SPP",
          "type": "text",
          "name": "spp_name",
          "required": false,
          "visible": true,
          "editable": true,
          "value": "SPP-0",
          "tooltip": "Name of the service protection profile",
          "description": "Name of the Service protection profile to get attack information."
        },
        {
          "title": "Direction",
          "type": "select",
          "name": "dir",
          "required": false,
          "visible": true,
          "editable": true,
          "value": "Inbound",
          "options": [
            "Inbound",
            "Outbound"
          ],
          "description": "Specify direction to retrieves attack information from FortiDDoS. You can choose between: Inbound or Outbound."
        },
        {
          "title": "Period",
          "type": "select",
          "name": "period",
          "required": false,
          "visible": true,
          "editable": true,
          "value": "1 year",
          "options": [
            "1 hour",
            "8 hours",
            "1 day",
            "1 week",
            "1 month",
            "1 year"
          ],
          "description": "Specify period to retrieves attack information from FortiDDoS. You can choose between: 1 hour, 8 hours, 1 day, 1 week, 1 month or 1 year."
        },
        {
          "title": "Subtype",
          "type": "select",
          "name": "subtype",
          "required": false,
          "visible": true,
          "editable": true,
          "value": "top_attacks",
          "options": [
            "top_attacks",
            "top_attackers",
            "top_acl_attacks",
            "top_attacked_spps",
            "top_attacked_acl_spps",
            "top_attacked_subnets",
            "top_acl_subnets",
            "top_attacked_destinations",
            "top_attacked_protocols",
            "top_attacked_tcp_ports",
            "top_attacked_udp_ports",
            "top_attacked_icmp_type_codes",
            "top_attacked_http_methods",
            "top_attacked_http_cookies",
            "top_attacked_http_referers",
            "top_attacked_http_user_agents",
            "top_attacked_http_hosts",
            "top_attacked_http_urls",
            "top_attacked_dns_servers",
            "top_attacked_dns_anomalies"
          ],
          "description": "Specify period to retrieves attack information from FortiDDoS. You can choose between: top_attacks, top_attackers, top_acl_attacks, top_attacked_spps, top_attacked_acl_spps, top_attacked_subnets, top_acl_subnets, top_attacked_destinations, top_attacked_protocols, top_attacked_tcp_ports, top_attacked_udp_ports, top_attacked_icmp_type_codes, top_attacked_http_methods, top_attacked_http_cookies, top_attacked_http_referers, top_attacked_http_user_agents, top_attacked_http_hosts, top_attacked_http_urls, top_attacked_dns_servers, top_attacked_dns_anomalies."
        }
      ],
      "conditional_output_schema": [
        {
          "condition": "{{true}}",
          "output_schema": {
            "data": [],
            "total": "",
            "success": "",
            "message": ""
          }
        },
        {
          "condition": "{{this['subtype'] === 'top_attackers' || this['subtype'] === 'top_attacked_destinations'}}",
          "output_schema": {
            "data": [
              {
                "IP": "",
                "SPP": "",
                "Direction": "",
                "Events": "",
                "Drops": "",
                "spp-id": ""
              }
            ],
            "total": "",
            "success": "",
            "message": ""
          }
        },
        {
          "condition": "{{this['subtype'] === 'top_attacked_tcp_ports' || this['subtype'] === 'top_attacked_udp_ports'}}",
          "output_schema": {
            "data": [
              {
                "Port": "",
                "SPP": "",
                "Direction": "",
                "Events": "",
                "Drops": "",
                "spp-id": ""
              }
            ],
            "total": "",
            "success": "",
            "message": ""
          }
        },
        {
          "condition": "{{this['subtype'] === 'top_attacked_icmp_type_codes'}}",
          "output_schema": {
            "data": [
              {
                "Type:Code": "",
                "SPP": "",
                "Direction": "",
                "Events": "",
                "Drops": "",
                "spp-id": ""
              }
            ],
            "total": "",
            "success": "",
            "message": ""
          }
        },
        {
          "condition": "{{this['subtype'] === 'top_attacks' || this['subtype'] === 'top_attacked_dns_servers' || this['subtype'] === 'top_attacked_dns_anomalies'}}",
          "output_schema": []
        }
      ]
    },
    {
      "title": "Add Distress ACL",
      "operation": "add_distress_acl",
      "description": "Add a new Distress ACL in FortiDDoS based on the parameters you have specified.",
      "category": "remediation",
      "annotation": "add_distress_acl",
      "enabled": true,
      "parameters": [
        {
          "title": "MKey",
          "type": "text",
          "name": "mkey",
          "required": true,
          "visible": true,
          "editable": true,
          "description": "MKey Name to add a new distress ACL to the FortiDDoS."
        },
        {
          "title": "ACL Enable",
          "type": "checkbox",
          "name": "acl-enable",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "description": "Select ACL enable to add a new Distress ACL into the FortiDDoS."
        },
        {
          "title": "Destination",
          "type": "select",
          "name": "destination",
          "required": true,
          "visible": true,
          "editable": true,
          "options": [
            "ip-netmask-ipv4",
            "all"
          ],
          "value": "all",
          "onchange": {
            "ip-netmask-ipv4": [
              {
                "title": "Destination IPv4 Netmask",
                "type": "text",
                "name": "destination-ipv4-netmask",
                "required": true,
                "visible": true,
                "editable": true,
                "placeholder": "eg. 0.0.0.0/0",
                "description": "Specify Destination IPv4 Netmask to add a new Distress ACL into the FortiDDoS."
              }
            ],
            "all": [
              {
                "title": "SPP Name",
                "type": "text",
                "name": "spp",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "SPP-0",
                "description": "Specify SPP name to add a new Distress ACL into the FortiDDoS."
              },
              {
                "title": "Destination IPv4 Netmask",
                "type": "text",
                "name": "destination-ipv4-netmask",
                "required": false,
                "visible": true,
                "editable": true,
                "value": "0.0.0.0/0",
                "description": "Specify Destination IPv4 Netmask to add a new Distress ACL into the FortiDDoS."
              }
            ]
          },
          "description": "Select destination to add a new Distress ACL in FortiDDoS. You can choose between: ip-netmask-ipv4, or all."
        },
        {
          "title": "Destination Port",
          "type": "checkbox",
          "name": "destination-port",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "Destination Port Start",
                "type": "text",
                "name": "destination-port-start",
                "required": true,
                "visible": true,
                "editable": true,
                "description": "Specify destination port start to add a new Distress ACL in FortiDDoS."
              },
              {
                "title": "Destination Port End",
                "type": "text",
                "name": "destination-port-end",
                "required": true,
                "visible": true,
                "editable": true,
                "description": "Specify destination port end to add a new Distress ACL in FortiDDoS."
              }
            ],
            "false": [
              {
                "title": "Threshold Per Million",
                "type": "text",
                "name": "threshold-per-million",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "1000000",
                "description": "Specify threshold per million to add a new Distress ACL in FortiDDoS. Eg: 1000000"
              }
            ]
          },
          "description": "Select this destination port checkbox to add a new Distress ACL in FortiDDoS. If you select this checkbox, then you must specify the following parameter: Destination Port Start, Destination Port End. If you do not select this checkbox specify: Threshold Per Million"
        },
        {
          "title": "DSCP",
          "type": "checkbox",
          "name": "dscp",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "DSCP Value",
                "type": "text",
                "name": "dscp-value",
                "required": true,
                "visible": true,
                "editable": true,
                "description": "Specify DSCP value to add a new Distress ACL in FortiDDoS."
              }
            ]
          },
          "description": "Select this DSCP checkbox to add a new Distress ACL in FortiDDoS. If you select this checkbox, then you must specify the following parameter: DSCP Value"
        },
        {
          "title": "Fragment",
          "type": "checkbox",
          "name": "fragment",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "Fragment Type",
                "type": "select",
                "name": "fragment-type",
                "required": false,
                "visible": true,
                "editable": true,
                "value": null,
                "options": [
                  "first-fragment",
                  "non-fragment-or-first-fragment",
                  "not-first-fragment",
                  "any-fragment"
                ]
              }
            ]
          },
          "description": "Select this fragment checkbox to add a new Distress ACL in FortiDDoS. If you select this checkbox, then you must specify the following parameter: Fragment Type"
        },
        {
          "title": "Protocol",
          "type": "checkbox",
          "name": "protocol",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "Protocol Number",
                "type": "text",
                "name": "protocol-number",
                "required": true,
                "visible": true,
                "editable": true,
                "description": "Specify protocol number to add a new Distress ACL in FortiDDoS."
              }
            ]
          },
          "description": "Select this protocol checkbox to add a new Distress ACL in FortiDDoS. If you select this checkbox, then you must specify the following parameter: Protocol Number."
        },
        {
          "title": "Source IP",
          "type": "checkbox",
          "name": "source-ip",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "Source IPv4 Netmask",
                "type": "text",
                "name": "source-ipv4-netmask",
                "required": true,
                "visible": true,
                "editable": true,
                "description": "Specify Source IPv4 Netmask to add a new Distress ACL in FortiDDoS."
              }
            ]
          },
          "description": "Select this source IP checkbox to add a new Distress ACL in FortiDDoS. If you select this checkbox, then you must specify the following parameter: Source IPv4 Netmask."
        },
        {
          "title": "Source Port",
          "type": "checkbox",
          "name": "source-port",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "Source Port Start",
                "type": "text",
                "name": "source-port-start",
                "required": false,
                "visible": true,
                "editable": true,
                "value": ""
              },
              {
                "title": "Source Port End",
                "type": "text",
                "name": "source-port-end",
                "required": false,
                "visible": true,
                "editable": true,
                "value": ""
              }
            ]
          },
          "description": "Select this source port checkbox to add a new Distress ACL in FortiDDoS. If you select this checkbox, then you must specify the following parameter: Source Port Start and Source Port End."
        },
        {
          "title": "TCP Control Flag",
          "type": "checkbox",
          "name": "tcp-control-flag",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "TCP Control Flag Options",
                "type": "text",
                "name": "tcp-control-flag-options",
                "required": false,
                "visible": true,
                "editable": true,
                "description": "Specify TCP control flag options to add a new Distress ACL in FortiDDoS."
              }
            ]
          },
          "description": "Select this TCP control flag checkbox to add a new Distress ACL in FortiDDoS. If you select this checkbox, then you must specify the following parameter: TCP Control Flag Options."
        },
        {
          "title": "TTL",
          "type": "checkbox",
          "name": "ttl",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "TTL Value",
                "type": "text",
                "name": "ttl-value",
                "required": true,
                "visible": true,
                "editable": true,
                "description": "Specify TTL Value to add a new Distress ACL in FortiDDoS."
              }
            ]
          },
          "description": "Select this TTL checkbox to add a new Distress ACL in FortiDDoS. If you select this checkbox, then you must specify the following parameter: TTL Value."
        }
      ],
      "output_schema": {
        "status": "",
        "message": ""
      }
    },
    {
      "title": "Add Service Protection Profile Policy",
      "operation": "add_service_protection_profile_policy",
      "description": "Adds a new SPP to the FortiDDoS based on the input parameters you have specified.",
      "category": "remediation",
      "annotation": "add_service_protection_profile_policy",
      "enabled": true,
      "parameters": [
        {
          "title": "Subnet ID",
          "type": "text",
          "name": "subnet-id",
          "required": true,
          "visible": true,
          "editable": true,
          "description": "Subnet ID to add a new SPP to the FortiDDoS."
        },
        {
          "title": "MKey Name",
          "type": "text",
          "name": "mkey",
          "required": true,
          "visible": true,
          "editable": true,
          "description": "MKey Name to add a new SPP to the FortiDDoS."
        },
        {
          "title": "IP Version",
          "type": "select",
          "name": "ip-version",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "IPv4",
          "options": [
            "IPv4",
            "IPv6"
          ],
          "onchange": {
            "IPv4": [
              {
                "title": "IPv4/Netmask",
                "type": "text",
                "name": "ip-addr-mask",
                "required": true,
                "visible": true,
                "editable": true,
                "description": "IPv4/Netmask to add a new SPP policy to the FortiDDoS."
              }
            ],
            "IPv6": [
              {
                "title": "IPv6/Prefix",
                "type": "text",
                "name": "ipv6-addr-prefix",
                "required": false,
                "visible": true,
                "editable": true,
                "description": "IPv6/Prefix to add a new SPP policy to the FortiDDoS."
              }
            ]
          },
          "description": "Select this IP version to add a new SPP policy in FortiDDoS. If you select IPv4 option, then you must specify the following parameter: IPv4/Netmask. If you select IPv6 option, then you must specify the following parameter: IPv6/Prefix."
        },
        {
          "title": "SPP",
          "type": "text",
          "name": "spp",
          "required": false,
          "visible": true,
          "editable": true,
          "value": "SPP-0",
          "tooltip": "Name of the service protection profile",
          "description": "Name of the Service protection profile add a new SPP policy to the FortiDDoS."
        },
        {
          "title": "Alternate SPP Enable",
          "type": "checkbox",
          "name": "alt-spp-enable",
          "required": true,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "Alternate SPP",
                "type": "text",
                "name": "alt-spp",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "SPP-0",
                "description": "Specify Alternate SPP to add a new SPP policy in FortiDDoS."
              },
              {
                "title": "Threshold Per Million",
                "type": "text",
                "name": "threshold-per-million",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "1000000",
                "description": "Specify threshold per million to add a new SPP policy in FortiDDoS."
              }
            ],
            "false": [
              {
                "title": "Threshold Per Million",
                "type": "text",
                "name": "threshold-per-million",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "1000000",
                "description": "Specify threshold per million to add a new SPP policy in FortiDDoS."
              }
            ]
          },
          "description": "Select this Alternate SPP Enable checkbox to add a new SPP policy to the FortiDDoS. If you select this checkbox, then you must specify the following parameter: Alternate SPP and Threshold Per Million. If you do not select this checkbox, then you must specify the following parameter: Threshold Per Million. "
        },
        {
          "title": "Comment",
          "type": "text",
          "name": "comment",
          "required": false,
          "visible": true,
          "editable": true,
          "value": "Added via FortiSOAR",
          "description": "Specify comment at the time of add a new SPP policy in FortiDDoS."
        }
      ]
    },
    {
      "title": "Update Service Protection Profile Settings",
      "operation": "update_service_protection_profile_settings",
      "description": "Update Service Protection Profile Settings (SPP) based on the inputs provided.",
      "category": "remediation",
      "annotation": "update_service_protection_profile_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "SPP Name",
          "type": "text",
          "name": "spp",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "SPP-0",
          "tooltip": "Name of the service protection profile",
          "description": "Name of the Service protection profile to update SPP settings."
        },
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "ddos_spp_setting",
          "options": [
            "ddos_spp_setting",
            "ddos_spp_firewall_service",
            "ddos_spp_firewall_policy",
            "ddos_spp_firewall_address",
            "ddos_spp_firewall_address6",
            "ddos_spp_tcp_session_extended_timeout_policy",
            "ddos_spp_threshold_scalar",
            "ddos_spp_threshold_http_methods",
            "ddos_spp_threshold_protocol",
            "ddos_spp_threshold_tcp_ports",
            "ddos_spp_threshold_udp_ports",
            "ddos_spp_threshold_icmp_type_codes",
            "ddos_spp_threshold_http_urls",
            "ddos_spp_threshold_http_hosts",
            "ddos_spp_threshold_http_referers",
            "ddos_spp_threshold_http_cookies",
            "ddos_spp_threshold_http_user_agents"
          ],
          "description": "Specify the name of the resource whose setting you want to update.\nFollowing are possible resource names: ddos_spp_setting, ddos_spp_firewall_service, ddos_spp_firewall_policy, ddos_spp_firewall_address, ddos_spp_firewall_address6, ddos_spp_tcp_session_extended_timeout_policy, ddos_spp_threshold_scalar, ddos_spp_threshold_http_methods, ddos_spp_threshold_protocol, ddos_spp_threshold_tcp_ports, ddos_spp_threshold_udp_ports, ddos_spp_threshold_icmp_type_codes, ddos_spp_threshold_http_urls, ddos_spp_threshold_http_hosts, ddos_spp_threshold_http_referers, ddos_spp_threshold_http_cookies, ddos_spp_threshold_http_user_agents."
        },
        {
          "title": "SPP Settings Arguments",
          "required": true,
          "visible": true,
          "editable": true,
          "type": "json",
          "name": "parameter_name_val",
          "tooltip": "SPP settings arguments in json format",
          "placeholder": "{\"field1\":value1, \"field2\":value2}",
          "value": {
            "inbound-operating-mode": "prevention"
          },
          "description": "Specify SPP setting arguments in JSON format at the time of update the SPP setting. You can enter the arguments in the following format: {\"field1\":value1, \"field2\":value2}. Eg: {\"inbound-operating-mode\":  \"prevention\"}"
        }
      ],
      "output_schema": {}
    },
    {
      "title": "Add Legitimate DNS Query",
      "operation": "add_lq",
      "description": "Adds a new Legitimate DNS Query to the FortiDDoS based on the input parameters you have specified.",
      "category": "remediation",
      "annotation": "add_lq",
      "enabled": true,
      "output_schema": {
        "data": "",
        "success": "",
        "message": ""
      },
      "parameters": [
        {
          "title": "Query",
          "type": "text",
          "name": "query",
          "required": true,
          "visible": true,
          "editable": true,
          "description": "Specify Query to add a new Legitimate DNS Query into the FortiDDoS."
        },
        {
          "title": "Type",
          "type": "text",
          "name": "type",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "1",
          "description": "Specify type to add a new Legitimate DNS Query into the FortiDDoS."
        },
        {
          "title": "Class",
          "type": "text",
          "name": "class",
          "required": false,
          "visible": true,
          "editable": true,
          "value": "1",
          "description": "Specify class to add a new Legitimate DNS Query into the FortiDDoS."
        }
      ]
    },
    {
      "title": "Delete Legitimate DNS Query",
      "operation": "delete_lq",
      "description": "Deletes legitimate DNS query from a specific from FortiDDoS based on the Domain and Type you have specified.",
      "category": "remediation",
      "annotation": "delete_lq",
      "enabled": true,
      "parameters": [
        {
          "title": "Domain",
          "description": "Specify domain for which you want to delete legitimate DNS query.",
          "type": "text",
          "name": "query",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Type",
          "description": "Specify type for which you want to delete legitimate DNS query.",
          "type": "text",
          "name": "type",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "1"
        },
        {
          "title": "Class",
          "type": "text",
          "name": "class",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "1",
          "description": "Specify class for which you want to delete legitimate DNS query."
        }
      ],
      "output_schema": {}
    },
    {
      "title": "Delete Service Protection Profile Policy",
      "operation": "delete_service_protection_profile_policy",
      "description": "Delete Service Protection Profile Policy based on the given policy name",
      "category": "remediation",
      "annotation": "delete_service_protection_profile_policy",
      "enabled": true,
      "parameters": [
        {
          "title": "SPP Policy Name",
          "description": "Specify the name of the policy which you want to delete.",
          "type": "text",
          "name": "policy_name",
          "required": true,
          "visible": true,
          "editable": true
        }
      ],
      "output_schema": {}
    },
    {
      "title": "Delete Distress ACL",
      "operation": "delete_distress_acl",
      "description": "Delete Distress ACL based on the name you have provided.",
      "category": "remediation",
      "annotation": "delete_distress_acl",
      "enabled": true,
      "parameters": [
        {
          "title": "Distress ACL Name",
          "description": "Specify the name of the distress ACL.",
          "type": "text",
          "name": "name",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "The name of the distress ACL which you want to delete."
        }
      ],
      "output_schema": {
        "status": "",
        "message": ""
      }
    },
    {
      "title": "Generate BGP Flowspec",
      "operation": "generate_bgp_flowspec",
      "description": "Generate BGP flow specifications based on the input you have provided.",
      "category": "containment",
      "annotation": "generate_bgp_flowspec",
      "enabled": true,
      "parameters": [
        {
          "title": "Vendor",
          "description": "Specify the vendor. The available options are Cisco and Juniper.",
          "type": "select",
          "name": "vendor",
          "required": true,
          "visible": true,
          "editable": true,
          "value": null,
          "options": [
            "Cisco",
            "Juniper"
          ]
        },
        {
          "title": "Destination",
          "description": "Specify the destination under attack.",
          "type": "text",
          "name": "destination",
          "required": true,
          "visible": true,
          "editable": true,
          "placeholder": "IPv4 Address"
        },
        {
          "title": "Threshold",
          "description": "Specify the threshold to generate BGP flow specifications.",
          "type": "integer",
          "name": "threshold",
          "required": true,
          "visible": true,
          "editable": true
        }
      ],
      "output_schema": {}
    }
  ]
}